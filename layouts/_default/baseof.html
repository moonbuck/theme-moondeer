{{/* Base template for all pages */}}
<!DOCTYPE html>
<html lang="en">

{{/* Define the page head */}}
<head>

{{/* Include the theme version */}}
{{ partial "comment.html" (printf "theme: Moondeer %s" site.Params.Theme.ThemeVersion) }}

{{ partial "plugins/precision-injection.html" (dict "prefix" "HEAD_TOP" "context" .) }}

{{/* Define character set and viewport */}}
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" 
      content="width=device-width, initial-scale=1, viewport-fit=cover">

{{/* Define site author */}}
<meta name="author" content="{{ site.Author.name }}">

{{/* Create a block defining the page title */}}
{{ block "title" . }}
{{ partial "head/page-title.html" . }}
{{ end }}

{{/* Create a block defining the page description */}}
{{ block "description" . }}
{{ partial "head/page-description.html" . }}
{{ end }}

{{/* Include links for the feeds */}}
{{ partial "head/feeds.html" . }}

{{/* Include links for the micropub, microsub, webmention, etc. */}}
<link rel="authorization_endpoint" 
      href="https://micro.blog/indieauth/auth" />
<link rel="token_endpoint" href="https://micro.blog/indieauth/token" />
<link rel="micropub" href="https://micro.blog/micropub" />
<link rel="microsub" href="https://micro.blog/microsub" />
<link rel="webmention" href="https://micro.blog/webmention" />
<link rel="subscribe" href="https://micro.blog/users/follow" />


{{/* Include core stylesheets */}}
<link rel="stylesheet" href="https://use.typekit.net/nmn4mcn.css">

{{ $base := resources.Get "sass/base.scss" | toCSS | fingerprint }}
<link rel="stylesheet" href="{{ $base.Permalink }}">

{{/* Create a block for including any additional stylesheets */}}
{{ block "stylesheets" . }}
{{ end }}

{{/* Include plugin stylesheets */}}
{{ partial "comment.html" "Injecting plugin stylesheets" }}
{{ range site.Params.plugins_css }}
<link rel="stylesheet" href="{{ . }}" />
{{ end }}

{{/* Include the custom stylesheet last */}}
<link rel="stylesheet" href="{{ "custom.css" | relURL }}">

{{/* Inject unprefixed plugin HTML includes */}}
{{ partial "plugins/precision-injection.html" (dict "context" .) }}

{{/* Create a block for including any additional head elements */}}
{{ block "head" . }}{{ end }}

{{/* Close the page head */}}
</head>

{{/* Define the page body */}}
<body>

{{ partial "plugins/precision-injection.html" (dict "prefix" "ABOVE_HEADER" "context" .) }}

{{/* Create a block for encapsulating navigation */}}
{{ block "navigation" . }}

{{/* Include default that handles most pages */}}
<nav id="main-nav" class="dark">
<a href="/">Latest</a>
{{ $page := . }}
{{ range site.Menus.main }}
<a class="{{ cond ($page.IsMenuCurrent "main" .) "selected" "" }}" 
   href="{{ .URL }}"><nobr>{{ .Title }}</nobr></a>
{{ end }}
</nav>

{{ partial "plugins/banner.html" . }}

{{ end }}

{{/* Wrap the main block within an identifiable section */}}
{{ $id := (urls.Parse .Permalink).Path | anchorize | default "home" }}
{{ $class := printf "wrapper kind-%s type-%s" .Kind .Type }}
<section id="{{ $id  }}" class="{{ $class }}">
  
{{/* Define a block for the primary page content */}}
{{ block "main" . }}

{{ end }}

</section>

{{/* Create a block for the page footer */}}
{{ block "footer" . }}
<footer id="feeds-email">

{{/* Create a list with feed links and email */}}
{{ partial "footer/link-list.html" . }}

</footer>
{{ end }}

{{/* Include the custom footer */}}
{{ partial "custom_footer.html" . }}

{{ partial "plugins/precision-injection.html" (dict "prefix" "BELOW_FOOTER" "context" .) }}

{{ partial "footer/copyright.html" }}

{{/* Insert plugin Javascript includes */}}
{{ range site.Params.plugins_js }}
<script src="{{ . }}"></script>
{{ end }}

{{/* Include visible theme version if flagged */}}
{{ partial "theme-version.html" . }}

{{/* Close the page body and html */}}
</body>
</html>